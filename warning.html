<!-- page to add event -->

<!DOCTYPE html>
<html>
  <head>
      <meta charset='utf-8'>
      <meta http-equiv='X-UA-Compatible' content='IE=edge'>
      <title>Add Event</title>
      <meta name='viewport' content='width=device-width, initial-scale=1'>
      <!-- Vue.js -->
      <script src="https://cdn.jsdelivr.net/npm/vue@3.2.16/dist/vue.global.prod.js"></script>
      <!-- Bootstrap CSS -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

      <!-- Add Axios Library -->
      <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

      <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'nonce-abc123';">
      <script src="warning.js"></script>
  </head>

  <body class="background m-0 p-0" id="app" style="background: url(img/bg.jpg) no-repeat center center fixed;
  background-size: cover; display: flex;">

    <div class="container d-flex" style="width: 50vw; height: 100vh; background-color: white; 
    flex-direction: column; margin-left: 0; align-items: center; justify-content: center;">

      <div class="p-3 container" style="overflow-y: auto; max-height: max-content;">

        <h1 class="fw-bold mb-2"> Uh Oh! </h1>

        <h3 style="color: #5A25A6;"> YOU HAVE BEEN SCAMMED </h3>

        <p class="fw-bold my-3"> well, almost. </p>

        <span class="mt-4 fw-light"> 
          
          The website you attempted to visit:
            
          <p class="my-2 mx-0 fw-bold" style="color: #5A25A6;"> {{ url }} </p>

          has a history of suspicious activity and is unsafe.

            </br> </br>

          <p class="fw-bold mb-4"> We wonâ€™t be here to protect you all the time. </p>

          <div class="justify-content-center d-flex">

            <button class="btn mt-3 rounded-pill fw-bold px-4" @click="getTips()" style="background-color: #AC7EBA;
            color: white; font-size: small;" id="button">
              LEARN HOW TO IDENTIFY SAFE WEBSITES
            </button>

          </div>

          <div class="container mt-3" id="tips"> 

            <div class="container p-3 px-4 mb-4" id="protocol" style="background-color: #AC7EBA; color: white; border-radius: 15px; display: none;">

              <span class="fw-bold fs-6"> 
              
                The website you tried to visit:
                
                <h6 class="fw-normal mt-2" style="overflow-wrap: break-word; text-decoration: underline;"> 

                  <span style="color: #403F69; text-decoration: underline;">{{ protocol }}</span>//{{domain}}/{{path}}/{{query}}
                   
                </h6>

                <div class="row p-0 d-flex justify-content-center align-items-center">

                  <div class="col-2 p-1">
                    <img src="img/warning.png" style="width: 100%; height: auto;">
                  </div>

                  <div class="col-10 p-1"> 
                    <span style="color: #403F69"> http </span> protocol is not secure
                  </div>

                </div>
                
              
              </span>

            </div>

            <div class="container p-3 px-4 mb-4" id="domain" style="background-color: #AC7EBA; color: white; border-radius: 15px; display: none;">

              <span class="fw-bold fs-6"> 
              
                The website you tried to visit:
                
                <h6 class="fw-normal mt-2" style="overflow-wrap: break-word; text-decoration: underline;"> 

                  {{ protocol }}//<span style="color: #403F69; text-decoration: underline;">{{domain}}</span>/{{path}}/{{query}}
                   
                </h6>

                <div class="row p-0 d-flex justify-content-center align-items-center">

                  <div class="col-2 p-1">
                    <img src="img/warning.png" style="width: 100%; height: auto;">
                  </div>

                  <div class="col-10 p-1"> 
                    The domain name <span style="color: #403F69; text-decoration: underline;">{{domain}}</span> is not in our whitelist
                  </div>

                </div>
                
              
              </span>

            </div>

            <div class="container p-3 px-4 mb-4" id="query" style="background-color: #AC7EBA; color: white; border-radius: 15px; display: none;">

              <span class="fw-bold fs-6"> 
              
                The website you tried to visit:
                
                <h6 class="fw-normal mt-2" style="overflow-wrap: break-word; text-decoration: underline;"> 

                  {{ protocol }}//{{domain}}/{{path}}/<span style="color: #403F69; text-decoration: underline;">{{query}}</span>
                   
                </h6>

                <div class="row p-0 d-flex justify-content-center align-items-center">

                  <div class="col-2 p-1">
                    <img src="img/warning.png" style="width: 100%; height: auto;">
                  </div>

                  <div class="col-10 p-1"> 
                    Query is susceptible to malicious attacks
                  </div>

                </div>
              
              </span>

            </div>

            <div class="container p-3 px-4 mb-4" id="safe" style="background-color: #41CD0F; color: white; border-radius: 15px; display: none;">

              <span class="fw-bold fs-6"> 
              
                Example of a safe website:
                
                <h6 class="fw-normal mt-2" style="overflow-wrap: break-word; text-decoration: underline;"> 

                  https://{{safeDomain}}/{{path}}/{{safeQuery}}
                   
                </h6>

                <div class="row p-0 d-flex justify-content-center align-items-center">

                  <div class="col-2 p-1">
                    <img src="img/tick.png" style="width: 100%; height: auto;">
                  </div>

                  <div class="col-10 p-1" v-html="safeTips"> 
                  </div>

                </div>
                
              
              </span>

            </div>

          </div>

        </span>

      </div>

    </div>

    <div class="container justify-content-center" style="display: flex; width: 50vw; height: 100vh; align-items: center;">
      <img src="img/warning_overlay.png" style="width: 80%; height: 80%; object-fit: contain;">
    </div>
      
  </body>

  <!-- <script nonce="abc123">

    // const url = window.location.href;
    // const url = "http://www.youtube.com/videos/user/search?query=lnx1n1ZM6Bc&ab_channel="

    const testUrls = {
      'http://localhost/hackathon/lifehack-24/websites/unsafe-protocol.html': 'http://www.internet-banking.dbs.com.sg/IB/welcome',
      'http://localhost/hackathon/lifehack-24/websites/unsafe-domain.html': 'https://www.internet.banking.sc.com.sg/IB/welcome?sg=1',
      'http://localhost/hackathon/lifehack-24/websites/unsafe-query.html': 'https://www.uob.com.sg/IB/welcome?sg=',
    }

    const url = testUrls[localStorage.getItem('url')];
    console.log(url);
    const temp = url.split('//');
    const protocol = temp[0];
    const urlArr = temp[1].split('/');
    const path = urlArr.slice(1, urlArr.length - 1).join('/');
    const domain = urlArr[0];
    const query = urlArr[urlArr.length - 1];

    const bankKeywords = {
        'dbs': 'www.dbs.com.sg',
        'ocbc': 'www.ocbc.com.sg',
        'uob': 'www.uob.com.sg',
        'hsbc': 'www.hsbc.com.sg',
        'sc': 'www.sc.com.sg',
        'cimb': 'www.cimbpreferred.com.sg',
        'citibank': 'www.citibank.com.sg',
        'maybank': 'www.maybank2u.com.sg',
    };

    

    const app = Vue.createApp({
      data() {
        return {
          url: url,
          protocol: protocol,
          domain: domain,
          path: path,
          query: query,
          safeDomain: "",
          safeQuery: "",
          safeTips: ""
        }
      },

      methods: {

        getTips() {

          document.getElementById("button").style.display = "none";

          if (protocol === "http:") {
            document.getElementById("protocol").style.display = "block";
            this.safeTips += "- Use HTTPS protocol </br>";
          }

          if (this.isBankDomain !== false && this.domain !== bankKeywords[this.isBankDomain]) {
            document.getElementById("domain").style.display = "block";
            this.safeDomain = bankKeywords[this.isBankDomain]
            this.safeTips += "- Visit websites with trusted domain names </br> ";
          }
          else {
            this.safeDomain = domain;
          }

          if (query.includes('?')) {

            queries = query.split('&')
            console.log(queries)

            for (check of queries) {
              console.log(check)
              if (check.split('=').size != 2 || check.split('=')[1] == "--") {
                document.getElementById("query").style.display = "block";
                this.safeTips += "- Avoid websites with suspicious queries </br>";
                this.safeQuery = "?query=example&key=value";
                break;
              }
            }

          }
          else {
            this.safeQuery = query;
          }

          document.getElementById("safe").style.display = "block"; 

        }

      },

      computed: {

        isBankDomain() {
          for (const [keyword, properDomain] of Object.entries(bankKeywords)) {
              if (this.domain.includes(keyword)) {
                  this.bankDomain = properDomain;
                  return keyword;
              }
          }
          return false;
        }

      }

    });

    app.mount('#app');
  
  </script> -->

</html>